# QQ-S Expert
Масштабное обновление для 3D принтера Flsun QQ-S Pro, включающее в себя множество изменений с целью повышения качества и скорости печати.

## Кратко о нововведениях
| # | Идея | Реализация |
|---|---|---|
| 1.|Калибровка стола производится с помощью фазового лазерного дальномера|В процессе|
| 2.|Катушка с филаментом теперь располагается внутри камеры печати на оси с подшипниками|В процессе|
| 3.|Автоматическая остановка, если филамент закончился|В процессе|
| 4.|Динамическое измерение толщины подаваемого прутка, коррекция G-Code (параметры `Flow` и `Retraction Distance`) по измеренным значениям, а так же запись сведений о расходе филамента в видах `Масса` и `Длина`|В процессе|
| 5.|Замена типа экструдера с Bowden на Direct|В процессе|
| 6.|Увеличение жёсткости конструкции за счет добавления дополнительных направляющих из алюминиевых трубок _D=16mm_ _d=12mm_|В процессе|
| 7.|Замена осевых тяг с ремней на однозаходные трапецеидальные винты _T12_ с шагом резьбы _2mm_|В процессе|
| 8.|Замена углепластиковых кронштейнов каретки экструдера на тяги из нержавеющей стали|В процессе|
| 9.|Переработка системы охлаждения пластика - замена вентиляторов на более продуктивные и замена заводских воздуховодов на правильно рассчитанные|В процессе|
|10.|Добавление системы охлаждения стола за счет нескольких мощных вентиляторов, позволяющей ускорить процесс отлипания заготовки от стола|В процессе|
|11.|Создание замкнутой камеры печати установкой тонкого стекла или оргстекла|В процессе|
|12.|Добавление вытяжки для откачки газа, образующегося при плавлении филамента|В процессе|
|13.|Установка двух светодиодных ламп для подсветки области печати|В процессе|
|14.|Косметическое улучшение добавлением ARGB ленты внутри камеры печати|В процессе|
|15.|Добавление дополнительного хост-устройства между ПК и принтером, корректирующего процесс печати|В процессе|
|16.|Улучшение безопасности - добавление _переключателя с ключом_ и _кнопки аварийной остановки_ в цепи сетевого питания принтера|В процессе|
|17.|Добавление шести релейных модулей для коммутации дополнительной электроники|В процессе|
|18.|Установка камеры для наблюдения за процессом печати через веб-интерфейс|В процессе|

## Подробно о нововведениях

### Фазовый лазерный дальномер

***
### Катушка внутри камеры печати

***
### Автоматическая остановка

***
### Динамическое измерение толщины прутка

***
### Обновлённый экструдер

***
### Конструкция с усиленной жёсткостью

***
### Трапецеидальные осевые винты

***
### Стальные кронштейны каретки экструдера

***
### Обновленная система охлаждения

#### Охлаждение детали

#### Охлаждение стола

***
### Замкнутая камера печати

***
### Вытяжка

***
### Светодиодное освещение

#### Подсветка области печати

#### Подсветка стекла

#### Подсветка кронштейнов каретки

***
### Хост-контроллер печати

#### Микроконтроллер

В качестве хост-контроллера выступает _WCH CH32V307VCT6_ - 32-битный микроконтроллер на архитектуре RISC-V с максимальной тактовой частотой _144MHz_, поддержкой Ethernet _10Mbps_ MAC и _1Gbps_ PHY, USB2.0HS Host, четырьмя портами GPIO, встроенными ЦАП и АЦП.

В альфа-версии будет использоваться EVT плата с данным микроконтроллером, на которой можно будет сразу проверить работу всех основных компонентов хост-контроллера и написать ПО к нему. В дальнейшем планируется использование отдельной печатной платы, спроектированной под определенный корпус и задачи.

#### Дисплейный модуль

#### Навигация

Для навигации по разделам меню хост-контроллера планируется использование двухосевого джойстика на датчиках Холла.

#### Индикация

В качестве индикаторов планируется использование адресных RGB светодиодов WS2012 в паре со световодами. Применение RGB светодиода в качестве индикатора позволит задать несколько разных цветов для разных значений одного параметра.

***
### Включение с ключом и аварийная остановка

Для того, чтобы обеспечить более безопасную эксплуатацию принтера, в разрыв сети питания принтера последовательно устанавливаются два переключателя. В моём случае, это КЕ131У3 (рис. А) и ПЕ171У3 (рис. Б)

| | |
|:---:|:---:|
|![рис. А][emergency]|![рис. Б][keyswitch]|
|рис. А|рис.Б|

Разумеется, лучше было бы использовать более современные переключатели с тем же функционалом из, например, семейства `LA38`. Такую возможность также _планируется_ добавить, когда у меня на руках будут такие переключатели. В случае же советского наследия, идея их использовать обусловлена целью применить их _хоть куда-то_ таким образом, чтобы от них была польза. 

Кнопка аварийной остановки устанавливается в разрыв цепи первой, она имеет одну **NC** пару контактов. Таким образом, когда принтер подключен к сети, и кнопка отжата - питание поступает на переключатель с ключом.

Переключатель с ключом имеет две пары контактов: одну **NC** и одну **NO**. В зависимости от потребностей эксплуатирующего, можно выбрать два сценария - либо блок питания принтера запитывается, только когда ключ _установлен и повернут_, либо же наоборот - только когда ключ _вынут_.

Схема подключения, использованная мной в этом проекте, приведена на рисунке ниже:

_В процессе_

***
### Релейная коммутация

***
### Камера наблюдения

***
## Требуемые компоненты

***
## Использовавшееся ПО

В процессе работы над проектом использовалось следующее ПО:

1. Altium Designer - схемы и печатные платы;
2. Solidworks - чертежи, 3D модели и рендеры;
3. MounRiver Studio - программный код для микроконтроллера;
4. Powershell - скрипты для Windows;
5. Wireshark - отладка веб-интерфейса;
6. OpenOCD - отладка микроконтроллера;
7. Ultimaker Cura - слайсинг моделей и взаимодействие с хост-контроллером.

[//]: <> (В этом блоке размещены изображения, использованные для данного README файла.)
[emergency]: pictures/16/emergency.jpg "КЕ131У3 исп. 2, кнопка аварийной остановки"
[keyswitch]: pictures/16/keyswitch.jpg "ПЕ171У3 исп. 2, переключатель с ключом"